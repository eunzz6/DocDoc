{% load static %}
<style>
   #wearableData, #id_file2{
      color: #001C30;
      font-weight: 600 ;}

   .btn-secondary {
      color: #fff;
      background-color: #1e88ff;
      border-color: #1e88ff;
         margin-top:3px;}
   
    .btn-secondary:hover {
    color: #fff;
        background-color: #004848;
        border-color: #004444; }
    .btn-check:focus + .btn-secondary, .btn-secondary:focus {
        color: #fff;
        background-color: #004848;
        border-color: #004444;
        -webkit-box-shadow: 0 0 0 0.25rem rgba(38, 111, 111, 0.5);
        box-shadow: 0 0 0 0.25rem rgba(38, 111, 111, 0.5); }
    .btn-check:checked + .btn-secondary,
    .btn-check:active + .btn-secondary, .btn-secondary:active, .btn-secondary.active,
    .show > .btn-secondary.dropdown-toggle {
        color: #fff;
        background-color: #004444;
        border-color: #004040; }
        .btn-check:checked + .btn-secondary:focus,
        .btn-check:active + .btn-secondary:focus, .btn-secondary:active:focus, .btn-secondary.active:focus,
        .show > .btn-secondary.dropdown-toggle:focus {
        -webkit-box-shadow: 0 0 0 0.25rem rgba(38, 111, 111, 0.5);
        box-shadow: 0 0 0 0.25rem rgba(38, 111, 111, 0.5); }
    .btn-secondary:disabled, .btn-secondary.disabled {
        color: #fff;
        background-color: #1e88ff;
        border-color: #1e88ff; }

    .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        flex-direction: column;
    }
    
    .loading-message {
        color: white;
        font-size: 24px;
    }
    .pl__worm--moving {
        animation: wormAnimation 1s linear infinite;
        }
    
        @keyframes wormAnimation {
        0% {
            stroke-dashoffset: 360;
        }
        100% {
            stroke-dashoffset: 0;
        }
        }
        
</style>

<!-- /*
* Template Name: Property
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!doctype html>
<html lang="en">
<head>
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="author" content="Untree.co">
   <link rel="shortcut icon" href="favicon.png">

   <meta name="description" content="" />
   <meta name="keywords" content="bootstrap, bootstrap5" />
   
   <link rel="preconnect" href="https://fonts.googleapis.com">
   <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">



    <link rel="stylesheet" href="{% static 'fonts/icomoon/style.css' %}">
    <link rel="stylesheet" href="{% static 'fonts/flaticon/font/flaticon.css' %}">

    <link rel="stylesheet" href="{% static 'css/bootstrap-grid.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-reboot.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-utilities.css' %}">

    <link rel="stylesheet" href="{% static 'css/tiny-slider.css' %}">
    <link rel="stylesheet" href="{% static 'css/aos.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">

   <title>DocDoc{% block title%}{%endblock%}</title>


</head>


<body>

   <div class="site-mobile-menu site-navbar-target">
      <div class="site-mobile-menu-header">
         <div class="site-mobile-menu-close">
            <span class="icofont-close js-menu-toggle"></span>
         </div>
      </div>
      <div class="site-mobile-menu-body"></div>
      
   </div>

   <nav class="site-nav" style="padding-top: 10px;">
      <div class="container">
        <form action="{% url 'login:logout' %}" method="post">
           {% csrf_token %}
           <button type="submit" class="btn btn-link" style="left: 92%;">
             <i class="bi bi-box-arrow-in-right" style="color: whitesmoke; font-size: 30px;line-height: 22px;"></i>
           </button>
        </form>
          <div class="menu-bg-wrap">
              <div class="site-navigation">
                  <a href="/main" class="logo m-0 float-start">DOCDOC</a>
                  <ul class="js-clone-nav d-none d-lg-inline-block text-start site-menu float-end">
                      <li class="active"><a href="/main">Home</a></li>
                 <li><a href="/about">About</a></li>
                      <li class="has-children" id="service-menu">
                    <a href="#">Service</a>
                    <ul class="dropdown">
                        <li><a href="/submit">Submit</a></li>
                        <li><a href="/search_main">Search</a></li>                                
                    </ul>
                </li>
                      <li><a href="/board">Board</a></li>
                      <li><a href="/contact">Contact Us</a></li>
                  </ul>
  
                  <a href="#" class="burger light me-auto float-end mt-1 site-menu-toggle js-menu-toggle d-inline-block d-lg-none" data-toggle="collapse" data-target="#main-navbar">
                  </a>
  
              </div>
          </div>
      </div>
  </nav>

   <div class="hero">


      <div class="hero-slide">
         <div class="img overlay" style="background-image: url('{% static 'images/doc_1.jpeg' %}')"></div>
         <div class="img overlay" style="background-image: url('{% static 'images/doc_2.jpeg' %}')"></div>
         <div class="img overlay" style="background-image: url('{% static 'images/doc_3.jpeg' %}')"></div>
      </div>
      
      <br><br><br>
      <div class="container">
         <div class="row justify-content-center align-items-center">
            <div class="col-lg-9 text-center">
               <h4 class="yammy" data-aos="fade-up" ><span class="highlight">DOCDOC</span>으로 최상의 의료서비스를 경험해보세요!</h4>
               <br>
               <hr class="custom-hr">

               <form method="post" action="{% url 'file_upload_app:submit' %}" enctype="multipart/form-data" class="centered-form" data-aos="fade-up">
                  {% csrf_token %}
                  <div class="row billboard-row" style="justify-content: space-around;">
                    <div class="col-lg-3 billboard-input">
                     <p style="color:whitesmoke">환자 성명, 식별 ID 등</p>
                     {{ form.name }}
                    </div>
                    <div class="col-lg-3 billboard-input">
                     <p style="color:whitesmoke">나이</p>
                     {{ form.age }}
                    </div>
                    <div class="col-lg-3 billboard-input">
                     <p style="color:whitesmoke">음성 데이터</p>
                     {% comment %} {{ form.file }} {% endcomment %}
                     <input type="file" id="wearableData" name="wearableData" accept="audio/*" >
                     <button type="button" class="btn-secondary" id="startRecordingButton" style="float: left;">녹음 시작</button>
                     
                    </div>
                     <div class="col-lg-3 billboard-input">
                        <p style="color:whitesmoke">웨어러블 데이터</p>
                        {{ form.file2 }}
                        
                        
                     {% if form.file.errors %}
                     <ul class="errorlist">
                       {% for error in form.file.errors %}
                       <li>{{ error }}</li>
                       {% endfor %}
                     </ul>
                     {% endif %}
                    </div>
                    <div class="col-lg-3 billboard-btn" style="flex:auto;">
                     <br><br>
                     <input type="submit" class="btn btn-primary" value="Submit">
                    </div>
                  </div>
                 </form>

                  
                  <script>

                  </script>
                
                 
                 <hr class="custom-hr">

               <form action="{% url 'file_upload_app:search_results' %}" class="narrow-w form-search d-flex align-items-stretch mb-3" data-aos="fade-up" data-aos-delay="200">
                  <input type="text" name="query" class="form-control px-4" placeholder="환자 성명, 식별 ID 등">
                  <button type="submit" class="btn btn-primary">Search</button>
               </form>
               
               
            </div>
         </div>
      </div>
   </div>

   <div class="site-footer">
      <div class="container">
         
         <div class="row">
            <div class="col-lg-4" style="width: 50%;" >
               <div class="widget" >
                  <h3>Contact</h3>
                  <address>15, Mudeung-ro 202beon-gil, Buk-gu,
                     Gwangju, Republic of Korea</address>
               </div> <!-- /.widget -->
            </div> <!-- /.col-lg-4 -->
            <div class="col-lg-4" style="width: 50%;">
               <div class="widget">
                  <h3>Sources</h3>
                  <ul style="display: flex; justify-content: space-between; padding:0px; ">
                     <p><a href="/about">About us</a></p>
                     <p><a href="/submit">Submit</a></p>
                     <p><a href="/search">Search</a></p>
                     <p><a href="/board">Board</a></p>
                     <p><a href="/contact">Contact us</a></p>
                     <p><a href="/use_acc">Privacy</a></p>
                  </ul>
               </div> <!-- /.widget -->
            </div> <!-- /.col-lg-4 -->
         </div> <!-- /.row -->

         <div class="row mt-5">
            <div class="col-12 text-center">
               <!-- 
              **==========
              NOTE: 
              Please don't remove this copyright link unless you buy the license here https://untree.co/license/  
              **==========
            -->

            <p>Copyright KT &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a> <!-- License information: https://untree.co/license/ -->
            </p>
          </div>
        </div>
      </div> <!-- /.container -->
    </div> <!-- /.site-footer -->


    <!-- Preloader -->
    <div id="overlayer"></div>
    <div class="loader">
       <div class="spinner-border" role="status">
          <span class="visually-hidden">Loading...</span>
       </div>
    </div>


    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'js/tiny-slider.js' %}"></script>
    <script src="{% static 'js/aos.js' %}"></script>
    <script src="{% static 'js/navbar.js' %}"></script>
    <script src="{% static 'js/counter.js' %}"></script>
    <script src="{% static 'js/custom.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/mic-recorder-to-mp3/dist/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    
    <script>
        const recordButton = document.getElementById('startRecordingButton');
        let isRecording = false;
        let recorder;

        recordButton.addEventListener('click', () => {
           if (!isRecording) {
           startRecording();
           } else {
           stopRecording();
           }
        });

        function startRecording() {
           navigator.mediaDevices.getUserMedia({ audio: true })
           .then(stream => {
              recorder = new MicRecorder({ bitRate: 128 });
              recorder.start().catch(err => console.error(err));
              isRecording = true;
              recordButton.textContent = '녹음 중지';
           })
           .catch(err => console.error(err));
        }

        function stopRecording() {
           recorder.stop()
              .getMp3().then(([buffer, blob]) => {
                 const file = new File(buffer, 'recorded_audio.wav', { type: blob.type });
                 recorder = null; 
                 isRecording = false;
                 console.log(isRecording)
                 recordButton.textContent = '녹음 시작';
                 
           
                 // 파일 변경을 위한 추가 코드
                 const dataTransfer = new DataTransfer();
                 dataTransfer.items.add(file);
           
                 const wearableDataInput = document.getElementById('wearableData');
                 wearableDataInput.files = dataTransfer.files;
              })
              .catch(err => console.error(err));
           }



      // Service 메뉴 클릭 시 이벤트 처리
      document.getElementById("service-menu").addEventListener("click", function(event) {
          event.preventDefault(); // 링크 이동을 막음
      });
     
      function showLoading() {
         var overlay = document.createElement('div');
         overlay.className = 'loading-overlay';
       
         var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
         svg.setAttribute('class', 'pl');
         svg.setAttribute('viewBox', '0 0 128 128');
         svg.setAttribute('width', '128px');
         svg.setAttribute('height', '128px');
         svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
       
         var g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
         g.setAttribute('fill', 'none');
         g.setAttribute('stroke-linecap', 'round');
         g.setAttribute('stroke-width', '16');
         g.setAttribute('transform', 'rotate(-90,64,64)');
       
   
       
         var circle2 = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
         circle2.setAttribute('class', 'pl__worm pl__worm--moving');
         circle2.setAttribute('r', '56');
         circle2.setAttribute('cx', '64');
         circle2.setAttribute('cy', '64');
         circle2.setAttribute('stroke', '#1e88ff');
         circle2.setAttribute('stroke-dasharray', '188.49555921538757 188.49555921538757');
         circle2.setAttribute('data-worm', '');
      
         g.appendChild(circle2);
         svg.appendChild(g);
       
         overlay.appendChild(svg);

         var message = document.createElement('div');
         message.className = 'loading-message';
         message.textContent = '진단 보고서 생성 중..';
         
         overlay.appendChild(message);

         document.body.appendChild(overlay);
       }
   
         // 요소 클릭 시 로딩 메시지 표시
         var submitButton = document.querySelector('.billboard-btn input[type="submit"]');
         submitButton.addEventListener('click', function() {
            showLoading();
         });
      </script>
  </body>
</html>